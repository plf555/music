webpackJsonp([2],{Us0B:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("BO1k"),n=i.n(a),l=i("Dd8w"),s=i.n(l),o=i("msXN"),r=i("NYxO"),c=(i("ttkU"),i("gyMJ")),u={mixins:[o.a],data:function(){return{singerId:"",singerName:"",centerDialogVisible:!1,editVisible:!1,delVisible:!1,pauseVisible:!1,registerForm:{name:"",singerName:"",album:"",lyric:"",style:""},songStyle:["流行","华语"],checkedStyles:["流行","华语"],form:{id:"",name:"",album:"",lyric:"",style:""},songName:"",tableData:[],tempData:[],select_word:"",pageSize:10,pageNum:1,total:0,idx:-1,multipleSelection:[],toggle:!1,song:{},styles:[{value:"华语",label:"华语"},{value:"粤语",label:"粤语"},{value:"欧美",label:"欧美"},{value:"日韩",label:"日韩"},{value:"摇滚",label:"摇滚"},{value:"民谣",label:"民谣"},{value:"流行",label:"流行"},{value:"选项8",label:"其他"}]}},computed:s()({},Object(r.b)(["isPlay"]),{data:function(){return this.tableData.slice((this.pageNum-1)*this.pageSize,this.pageNum*this.pageSize)}}),watch:{select_word:function(){if(""==this.select_word)this.tableData=this.tempData;else{this.tableData=[];var e=!0,t=!1,i=void 0;try{for(var a,l=n()(this.tempData);!(e=(a=l.next()).done);e=!0){var s=a.value;s.name.includes(this.select_word)&&this.tableData.push(s)}}catch(e){t=!0,i=e}finally{try{!e&&l.return&&l.return()}finally{if(t)throw i}}}}},created:function(){this.singerId=this.$route.query.id,this.singerName=this.$route.query.name,this.getData()},destroyed:function(){this.pauseVisible=!0,this.$store.commit("setIsPlay",!1)},methods:{handleCheckedCitiesChange:function(e){this.form.style=e},handleCurrentChange:function(e){this.pageNum=e,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},getData:function(){var e=this;this.tempData=[],this.tableData=[];var t={pageSize:this.pageSize,pageNum:this.pageNum,songName:this.songName,singerId:this.singerId};Object(c.B)(t).then(function(t){e.tempData=t.data.records,e.tableData=t.data.records,e.total=t.data.total})},addSong:function(){var e=this,t=new FormData(document.getElementById("tf"));t.set("style",e.songStyle.toString()),t.append("singerId",this.singerId),t.set("name",t.get("name")),t.get("lyric")||t.set("lyric","[00:00:00]暂无歌词");var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var t=JSON.parse(i.response);1==t.code?(e.getData(),e.registerForm={},e.notify(t.message,"success")):e.notify(t.message,"error")}},i.open("post",e.$store.state.HOST+"/song/add",!1),i.send(t),e.centerDialogVisible=!1},handleEdit:function(e){this.editVisible=!0,this.form={id:e.id,name:e.name,album:e.album,lyric:e.lyric,style:e.style}},editSave:function(){var e=this;this.song.id=this.form.id,this.song.name=this.form.name,this.song.album=this.form.album,this.song.lyric=this.form.lyric,this.song.style=this.form.style.toString();var t=this.song;Object(c.F)(t).then(function(t){1==t.code?(e.getData(),e.notify(t.message,"success")):e.notify(t.message,"error")}).catch(function(e){console.log(e)}),this.editVisible=!1},uploadUrl:function(e){return this.$store.state.HOST+"/song/updateSongPic?id="+e},deleteRow:function(){var e=this;Object(c.h)(this.idx).then(function(t){t?(e.getData(),e.notify(t.message,"success")):e.notify(t.message,"error")}).catch(function(e){console.log(e)}),this.delVisible=!1},parseLyric:function(e){var t=e.split("\n"),i=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,a=[],l=!0,s=!1,o=void 0;try{for(var r,c=n()(t);!(l=(r=c.next()).done);l=!0){var u=r.value.replace(i,"");a.push(u)}}catch(e){s=!0,o=e}finally{try{!l&&c.return&&c.return()}finally{if(s)throw o}}return a},beforeSongUpload:function(e){return"mp3"==e.name.substring(e.name.lastIndexOf(".")+1)||(this.$message({message:"文件格式错误",type:"error"}),!1)},handleSongSuccess:function(e){1==e.code?(this.getData(),this.$notify({title:e.message,type:"success"})):this.$notify({title:e.message,type:"error"})},uploadSongUrl:function(e){return this.$store.state.HOST+"/song/updateSong?id="+e},setSongUrl:function(e,t){this.toggle==t?(this.toggle=!1,this.$store.commit("setIsPlay",!1)):(this.toggle=t,this.$store.commit("setUrl",this.$store.state.HOST+"/"+e),this.$store.commit("setIsPlay",!0))}}},d={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"table"},[i("div",{staticClass:"crumbs"},[i("i",{staticClass:"el-icon-tickets",staticStyle:{"font-size":"18px","padding-top":"18px"}},[e._v(e._s(this.singerName)+"-音乐列表")])]),e._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[e._v("\n            在当前页搜索：\n            "),i("el-input",{staticClass:"handle-input",attrs:{size:"mini",placeholder:"请输入歌曲名"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),e._v(" "),i("br"),e._v(" "),i("br"),e._v("\n            搜  索  全  部 ：\n            "),i("el-input",{staticClass:"handle-input",attrs:{size:"mini",placeholder:"请输入歌曲名"},model:{value:e.songName,callback:function(t){e.songName=t},expression:"songName"}}),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.getData}},[e._v("搜索")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.delBatch}},[e._v("批量删除")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.centerDialogVisible=!0}}},[e._v("添加歌曲")])],1)]),e._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",height:"680px",data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),i("el-table-column",{attrs:{label:"歌曲图片",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticClass:"song-img"},[i("img",{staticStyle:{width:"100%"},attrs:{src:e.getUrl(t.row.pic)}})]),e._v(" "),i("div",{staticClass:"play",on:{click:function(i){return e.setSongUrl(t.row.url,t.row.name)}}},[e.toggle==t.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-zanting"}})])]):e._e(),e._v(" "),e.toggle!=t.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-bofanganniu"}})])]):e._e()])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"歌名",width:"120",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"album",label:"专辑",width:"150",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"歌词",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("ul",{staticStyle:{height:"100px","overflow-y":"scroll"}},e._l(e.parseLyric(t.row.lyric),function(t,a){return i("li",{key:a},[e._v("\n                        "+e._s(t)+"\n                    ")])}),0)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"资源更新",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-upload",{attrs:{action:e.uploadUrl(t.row.id),"before-upload":e.beforeAvatarUpload,"on-success":e.handleAvatarSuccess}},[i("el-button",{attrs:{size:"mini"}},[e._v("更新图片")])],1),e._v(" "),i("br"),e._v(" "),i("el-upload",{attrs:{action:e.uploadSongUrl(t.row.id),"before-upload":e.beforeSongUpload,"on-success":e.handleSongSuccess}},[i("el-button",{attrs:{size:"mini"}},[e._v("更新歌曲")])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{background:"",page:e.pageNum,"page-sizes":[1,10,20,50],limit:e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:this.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:page":function(t){e.pageNum=t},"update:limit":function(t){e.pageSize=t}}})],1),e._v(" "),i("el-dialog",{attrs:{title:"添加歌曲",visible:e.centerDialogVisible,width:"400px",center:""},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[i("el-form",{ref:"registerForm",attrs:{model:e.registerForm,"label-width":"80px",action:"",id:"tf"}},[i("div",[i("label",[e._v("歌名")]),e._v(" "),i("el-input",{attrs:{type:"text",name:"name"},model:{value:e.registerForm.name,callback:function(t){e.$set(e.registerForm,"name",t)},expression:"registerForm.name"}})],1),e._v(" "),i("div",[i("label",[e._v("专辑")]),e._v(" "),i("el-input",{attrs:{type:"text",name:"album"},model:{value:e.registerForm.album,callback:function(t){e.$set(e.registerForm,"album",t)},expression:"registerForm.album"}})],1),e._v(" "),i("div",[i("label",[e._v("歌词")]),e._v(" "),i("el-input",{attrs:{type:"textarea",name:"lyric"},model:{value:e.registerForm.lyric,callback:function(t){e.$set(e.registerForm,"lyric",t)},expression:"registerForm.lyric"}})],1),e._v(" "),i("div",[i("label",[e._v("风格")]),e._v(" "),i("el-select",{attrs:{multiple:"","multiple-limit":3,name:"style",placeholder:"请选择至多3项"},model:{value:e.songStyle,callback:function(t){e.songStyle=t},expression:"songStyle"}},e._l(e.styles,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("div",[i("label",[e._v("歌曲上传")]),e._v(" "),i("input",{attrs:{type:"file",name:"file"}})])]),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.centerDialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:e.addSong}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"修改歌曲",visible:e.editVisible,width:"400px",center:""},on:{"update:visible":function(t){e.editVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{prop:"name",label:"歌名",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"album",label:"专辑",size:"mini"}},[i("el-input",{attrs:{placeholder:"专辑"},model:{value:e.form.album,callback:function(t){e.$set(e.form,"album",t)},expression:"form.album"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"lyric",label:"歌词",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌词",type:"textarea"},model:{value:e.form.lyric,callback:function(t){e.$set(e.form,"lyric",t)},expression:"form.lyric"}})],1),e._v(" "),i("el-form-item",{attrs:{prop:"style",label:"风格",size:"mini"}},[i("el-select",{attrs:{multiple:"","multiple-limit":3,placeholder:"请选择至多3项"},model:{value:e.form.style,callback:function(t){e.$set(e.form,"style",t)},expression:"form.style"}},e._l(e.styles,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.editVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:e.editSave}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"删除歌曲",visible:e.delVisible,width:"300px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[i("div",{attrs:{align:"center"}},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.delVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:e.deleteRow}},[e._v("确定")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"暂停歌曲？",visible:e.pauseVisible,width:"300px",center:""},on:{"update:visible":function(t){e.pauseVisible=t}}},[i("div",{attrs:{align:"center"}},[e._v("是否暂停当前播放歌曲？")]),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){e.pauseVisible=!1}}},[e._v("继续播放")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.deleteRow}},[e._v("停止播放")])],1)])],1)},staticRenderFns:[]};var m=i("VU/8")(u,d,!1,function(e){i("VAxX")},"data-v-41ec95c5",null);t.default=m.exports},VAxX:function(e,t){},ttkU:function(e,t){!function(e){var t,i='<svg><symbol id="icon-bofanganniu" viewBox="0 0 1024 1024"><path d="M927.870095 571.688039 167.320423 1014.160886C121.562471 1041.981153 61.44 1007.279555 61.44 954.218179L61.44 68.595037C63.693916 16.802233 124.631347-17.041827 171.276012 8.961322L928.382003 451.43039C974.037627 479.202079 974.037627 543.611136 927.870095 571.688039Z"  ></path></symbol><symbol id="icon-zanting" viewBox="0 0 1024 1024"><path d="M268.97201558 114.31784297c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z m486.05596884 0c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z"  ></path></symbol></svg>';if((t=document.getElementsByTagName("script"))[t.length-1].getAttribute("data-injectcss")&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(t){console&&console.log(t)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e,!1),t()},!1)}else document.attachEvent&&(a=t,n=e.document,l=!1,(s=function(){try{n.documentElement.doScroll("left")}catch(e){return void setTimeout(s,50)}i()})(),n.onreadystatechange=function(){"complete"==n.readyState&&(n.onreadystatechange=null,i())});function i(){l||(l=!0,a())}var a,n,l,s}(function(){var e,t;(e=document.createElement("div")).innerHTML=i,i=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",function(e,t){t.firstChild?function(e,t){t.parentNode.insertBefore(e,t)}(e,t.firstChild):t.appendChild(e)}(t,document.body))})}(window)}});
//# sourceMappingURL=2.d79990e6f90b6fa7cae1.js.map